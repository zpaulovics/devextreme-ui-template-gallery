<dx-data-grid
  id="tasks-grid"
  class="theme-dependent"
  height="100%"
  [dataSource]="tasks"
  (onRowClick)="navigateToDetails($event)"
  (onEditingStart)="toogleUseNavigation()"
  (onEditCanceled)="toogleUseNavigation()"
  (onSaved)="toogleUseNavigation()"
  [hoverStateEnabled]="true"
  [columnAutoWidth]="true"
  [showBorders]="true"
>
  <dxo-paging [pageSize]="15" />
  <dxo-pager [visible]="true" [showPageSizeSelector]="true" />
  <dxo-editing mode="row" [allowUpdating]="true" />
  <dxo-selection selectAllMode="allPages"
    showCheckBoxesMode="always"
    mode="multiple"
   />
  <dxo-scrolling mode="virtual" />
  <dxo-sorting mode="multiple" />
  <dxo-header-filter [visible]="true" />

  <dxi-column dataField="text" caption="Subject" [hidingPriority]="7">
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column dataField="company" caption="Company" [hidingPriority]="6">
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column
    dataField="priority"
    caption="Priority"
    [hidingPriority]="4"
    cellTemplate="cellPriority"
    editCellTemplate="editCellPriority"
  >
    <dxo-lookup [dataSource]="priorityList" />
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column
    dataField="startDate"
    caption="Start Date"
    dataType="date"
    [hidingPriority]="2"
  >
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column
    dataField="dueDate"
    caption="Due Date"
    dataType="date"
    sortOrder="asc"
    [hidingPriority]="1"
  >
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column dataField="owner" caption="Owner" [hidingPriority]="5">
    <dxi-validation-rule type="required" />
  </dxi-column>
  <dxi-column
    dataField="status"
    caption="Status"
    [hidingPriority]="3"
    [minWidth]="120"
    cellTemplate="cellStatus"
    editCellTemplate="editCellStatus"
  >
    <dxo-lookup [dataSource]="statusList" />
    <dxi-validation-rule type="required" />
  </dxi-column>

  <div *dxTemplate="let cellInfo of 'cellPriority'">
    <status-indicator
      [isField]="false"
      [showBar]="true"
      [value]="cellInfo.data.priority"
    >
    </status-indicator>
  </div>

  <div *dxTemplate="let cellInfo of 'editCellPriority'">
    <dx-select-box
      class="edit-cell"
      [(value)]="cellInfo.value"
      [items]="priorityList"
      (onValueChanged)="cellInfo.setValue($event.value)"
      (onSelectionChanged)="cellInfo.component.updateDimensions()"
      fieldTemplate="field"
    >
      <div *dxTemplate="let data of 'field'">
        <status-indicator
          [showBar]="true"
          [value]="cellInfo.value"
        ></status-indicator>
      </div>
      <div *dxTemplate="let data of 'item'">
        <status-indicator
          [showBar]="true"
          [isField]="false"
          [value]="data"
        ></status-indicator>
      </div>
    </dx-select-box>
  </div>

  <div *dxTemplate="let cellInfo of 'cellStatus'">
    <status-indicator
      [isField]="false"
      [value]="cellInfo.data.status"
    ></status-indicator>
  </div>

  <div *dxTemplate="let cellInfo of 'editCellStatus'">
    <dx-select-box
      class="edit-cell"
      [(value)]="cellInfo.value"
      [items]="statusList"
      (onValueChanged)="cellInfo.setValue($event.value)"
      (onSelectionChanged)="cellInfo.component.updateDimensions()"
      fieldTemplate="field"
    >
      <div *dxTemplate="let data of 'field'">
        <status-indicator [value]="cellInfo.value"></status-indicator>
      </div>
      <div *dxTemplate="let s of 'item'">
        <status-indicator [isField]="false" [value]="s"></status-indicator>
      </div>
    </dx-select-box>
  </div>
</dx-data-grid>
